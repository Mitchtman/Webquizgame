var population_dictionary = {
    'cn.png': 1439324,
    'in.png': 1380004,
    'us.png': 331003,
    'id.png': 273524,
    'pk.png': 220892,
    'br.png': 212559,
    'ng.png': 206140,
    'bd.png': 164689,
    'ru.png': 145934,
    'mx.png': 128933,
    'jp.png': 126476,
    'et.png': 114964,
    'ph.png': 109581,
    'eg.png': 102334,
    'vn.png': 97339,
    'cd.png': 89561,
    'tr.png': 84339,
    'ir.png': 83993,
    'de.png': 83784,
    'th.png': 69800,
    'gb.png': 67886,
    'fr.png': 65274,
    'it.png': 60462,
    'tz.png': 59734,
    'za.png': 59309,
    'mm.png': 54410,
    'ke.png': 53771,
    'kr.png': 51269,
    'co.png': 50883,
    'es.png': 46755,
    'ug.png': 45741,
    'ar.png': 45196,
    'dz.png': 43851,
    'sd.png': 43849,
    'ua.png': 43734,
    'iq.png': 40222,
    'af.png': 38928,
    'pl.png': 37847,
    'ca.png': 37742,
    'ma.png': 36911,
    'sa.png': 34814,
    'uz.png': 33469,
    'pe.png': 32972,
    'ao.png': 32866,
    'my.png': 32366,
    'mz.png': 31255,
    'gh.png': 31073,
    'ye.png': 29826,
    'np.png': 29137,
    've.png': 28436,
    'mg.png': 27691,
    'cm.png': 26546,
    'ci.png': 26378,
    'kp.png': 25779,
    'au.png': 25500,
    'ne.png': 24207,
    'lk.png': 21413,
    'bf.png': 20903,
    'ml.png': 20251,
    'ro.png': 19238,
    'mw.png': 19130,
    'cl.png': 19116,
    'kz.png': 18777,
    'zm.png': 18384,
    'gt.png': 17916,
    'ec.png': 17643,
    'sy.png': 17501,
    'nl.png': 17135,
    'sn.png': 16744,
    'kh.png': 16719,
    'td.png': 16426,
    'so.png': 15893,
    'zw.png': 14863,
    'gn.png': 13133,
    'rw.png': 12952,
    'bj.png': 12123,
    'bi.png': 11891,
    'tn.png': 11819,
    'bo.png': 11673,
    'be.png': 11590,
    'ht.png': 11402,
    'cu.png': 11327,
    'ss.png': 11194,
    'do.png': 10848,
    'cz.png': 10709,
    'gr.png': 10423,
    'jo.png': 10203,
    'pt.png': 10197,
    'az.png': 10139,
    'se.png': 10099,
    'hn.png': 9905,
    'ae.png': 9890,
    'hu.png': 9660,
    'tj.png': 9538,
    'by.png': 9449,
    'at.png': 9006,
    'pg.png': 8947,
    'rs.png': 8737,
    'il.png': 8656,
    'ch.png': 8655,
    'tg.png': 8279,
    'sl.png': 7977,
    'hk.png': 7497,
    'la.png': 7276,
    'py.png': 7132,
    'bg.png': 6948,
    'ly.png': 6871,
    'lb.png': 6825,
    'ni.png': 6625,
    'kg.png': 6524,
    'sv.png': 6486,
    'tm.png': 6031,
    'sg.png': 5850,
    'dk.png': 5792,
    'fi.png': 5541,
    'cg.png': 5518,
    'sk.png': 5460,
    'no.png': 5421,
    'om.png': 5107,
    'ps.png': 5101,
    'cr.png': 5094,
    'lr.png': 5058,
    'ie.png': 4938,
    'cf.png': 4830,
    'nz.png': 4822,
    'mr.png': 4650,
    'pa.png': 4315,
    'kw.png': 4271,
    'hr.png': 4105,
    'md.png': 4034,
    'ge.png': 3989,
    'er.png': 3546,
    'uy.png': 3474,
    'ba.png': 3281,
    'mn.png': 3278,
    'am.png': 2963,
    'jm.png': 2961,
    'qa.png': 2881,
    'al.png': 2878,
    'pr.png': 2861,
    'lt.png': 2722,
    'na.png': 2541,
    'gm.png': 2417,
    'bw.png': 2352,
    'ga.png': 2226,
    'ls.png': 2142,
    'mk.png': 2083,
    'si.png': 2079,
    'gw.png': 1968,
    'lv.png': 1886,
    'bh.png': 1702,
    'gq.png': 1403,
    'tt.png': 1400,
    'ee.png': 1326,
    'tl.png': 1318,
    'mu.png': 1272,
    'cy.png': 1207,
    'sz.png': 1160,
    'dj.png': 988,
    'fj.png': 896,
    're.png': 895,
    'km.png': 870,
    'gy.png': 787,
    'bt.png': 772,
    'sb.png': 687,
    'mo.png': 649,
    'me.png': 628,
    'lu.png': 626,
    'eh.png': 597,
    'sr.png': 587,
    'cv.png': 556,
    'mv.png': 540,
    'mt.png': 442,
    'bn.png': 438,
    'gp.png': 400,
    'bz.png': 398,
    'bs.png': 393,
    'mq.png': 375,
    'is.png': 341,
    'vu.png': 307,
    'gf.png': 299,
    'bb.png': 287,
    'nc.png': 286,
    'pf.png': 281,
    'yt.png': 273,
    'st.png': 219,
    'ws.png': 198,
    'lc.png': 184,
    'gu.png': 169,
    'cw.png': 164,
    'ki.png': 119,
    'fm.png': 115,
    'gd.png': 112,
    'vc.png': 111,
    'aw.png': 107,
    'to.png': 106,
    'vi.png': 104,
    'ag.png': 98,
    'sc.png': 98,
    'im.png': 86,
    'ad.png': 77,
    'dm.png': 75,
    'ky.png': 64,
    'bm.png': 61,
    'gl.png': 57,
    'kn.png': 57,
    'as.png': 56,
    'mp.png': 55,
    'mh.png': 53,
    'fo.png': 50,
    'sx.png': 41,
    'li.png': 39,
    'mc.png': 39,
    'tc.png': 37,
    'gi.png': 35,
    'sm.png': 34,
    'vg.png': 33,
    'bq.png': 26,
    'pw.png': 22,
    'ck.png': 18,
    'ai.png': 15,
    'tv.png': 12,
    'wf.png': 12,
    'nr.png': 11,
    'pm.png': 6,
    'ms.png': 5,
    'sh.png': 4,
    'fk.png': 3,
    'nu.png': 2,
    'tk.png': 1,
    'va.png': 1,
    'aq.png': 0,
    'ax.png': 0,
    'bl.png': 0,
    'bv.png': 0,
    'cc.png': 0,
    'cx.png': 0,
    'gg.png': 0,
    'gs.png': 0,
    'hm.png': 0,
    'io.png': 0,
    'je.png': 0,
    'mf.png': 0,
    'nf.png': 0,
    'pn.png': 0,
    'sj.png': 0,
    'tf.png': 0,
    'tw.png': 0,
    'um.png': 0,
    'xk.png': 0
};

var flag_dictionary = {
    'ad.png': 'Andorra',
    'ae.png': 'United Arab Emirates',
    'af.png': 'Afghanistan',
    'ag.png': 'Antigua and Barbuda',
    'ai.png': 'Anguilla',
    'al.png': 'Albania',
    'am.png': 'Armenia',
    'ao.png': 'Angola',
    'aq.png': 'Antarctica',
    'ar.png': 'Argentina',
    'as.png': 'American Samoa',
    'at.png': 'Austria',
    'au.png': 'Australia',
    'aw.png': 'Aruba',
    'ax.png': 'Aland Islands',
    'az.png': 'Azerbaijan',
    'ba.png': 'Bosnia and Herzegovina',
    'bb.png': 'Barbados',
    'bd.png': 'Bangladesh',
    'be.png': 'Belgium',
    'bf.png': 'Burkina Faso',
    'bg.png': 'Bulgaria',
    'bh.png': 'Bahrain',
    'bi.png': 'Burundi',
    'bj.png': 'Benin',
    'bl.png': 'Saint Barthelemy',
    'bm.png': 'Bermuda',
    'bn.png': 'Brunei',
    'bo.png': 'Bolivia',
    'bq.png': 'Caribbean Netherlands',
    'br.png': 'Brazil',
    'bs.png': 'The Bahamas',
    'bt.png': 'Bhutan',
    'bv.png': 'Bouvet Island',
    'bw.png': 'Botswana',
    'by.png': 'Belarus',
    'bz.png': 'Belize',
    'ca.png': 'Canada',
    'cc.png': 'Cocos Islands',
    'cd.png': 'Democratic Republic of the Congo',
    'cf.png': 'Central African Republic',
    'cg.png': 'Republic of the Congo',
    'ch.png': 'Switzerland',
    'ci.png': 'Cote d\'Ivoire',
    'ck.png': 'Cook Islands',
    'cl.png': 'Chile',
    'cm.png': 'Cameroon',
    'cn.png': 'China',
    'co.png': 'Colombia',
    'cr.png': 'Costa Rica',
    'cu.png': 'Cuba',
    'cv.png': 'Cabo Verde',
    'cw.png': 'Curacao',
    'cx.png': 'Christmas Island',
    'cy.png': 'Cyprus',
    'cz.png': 'Czechia',
    'de.png': 'Germany',
    'dj.png': 'Djibouti',
    'dk.png': 'Denmark',
    'dm.png': 'Dominica',
    'do.png': 'Dominican Republic',
    'dz.png': 'Algeria',
    'ec.png': 'Ecuador',
    'ee.png': 'Estonia',
    'eg.png': 'Egypt',
    'eh.png': 'Western Sahara',
    'er.png': 'Eritrea',
    'es.png': 'Spain',
    'et.png': 'Ethiopia',
    'fi.png': 'Finland',
    'fj.png': 'Fiji',
    'fk.png': 'Falkland Islands',
    'fm.png': 'Micronesia',
    'fo.png': 'Faroe Islands',
    'fr.png': 'France',
    'ga.png': 'Georgia',
    'gb-eng.png': 'England',
    'gb-nir.png': 'Northern Ireland',
    'gb-sct.png': 'Scotland',
    'gb-wls.png': 'Wales',
    'gb.png': 'United Kingdom',
    'gd.png': 'Grenada',
    'ge.png': 'Georgia',
    'gf.png': 'French Guiana',
    'gg.png': 'Guernsey',
    'gh.png': 'Ghana',
    'gi.png': 'Gibraltar',
    'gl.png': 'Greenland',
    'gm.png': 'The Gambia',
    'gn.png': 'Guinea',
    'gp.png': 'Guadeloupe',
    'gq.png': 'Equatorial Guinea',
    'gr.png': 'Greece',
    'gs.png': 'South Georgia',
    'gt.png': 'Guatemala',
    'gu.png': 'Guam',
    'gw.png': 'Guinea-Bissau',
    'gy.png': 'Guyana',
    'hk.png': 'Hong Kong',
    'hm.png': 'Heard and McDonald Islands',
    'hn.png': 'Honduras',
    'hr.png': 'Croatia',
    'ht.png': 'Haiti',
    'hu.png': 'Hungary',
    'id.png': 'Indonesia',
    'ie.png': 'Ireland',
    'il.png': 'Israel',
    'im.png': 'Isle of Man',
    'in.png': 'India',
    'io.png': 'British Indian Ocean Territory',
    'iq.png': 'Iraq',
    'ir.png': 'Iran',
    'is.png': 'Iceland',
    'it.png': 'Italy',
    'je.png': 'Jersey',
    'jm.png': 'Jamaica',
    'jo.png': 'Jordan',
    'jp.png': 'Japan',
    'ke.png': 'Kenya',
    'kg.png': 'Kyrgyzstan',
    'kh.png': 'Cambodia',
    'ki.png': 'Kiribati',
    'km.png': 'Comoros',
    'kn.png': 'Saint Kitts and Nevis',
    'kp.png': 'North Korea',
    'kr.png': 'South Korea',
    'kw.png': 'Kuwait',
    'ky.png': 'Cayman Islands',
    'kz.png': 'Kazakhstan',
    'la.png': 'Laos',
    'lb.png': 'Lebanon',
    'lc.png': 'Saint Lucia',
    'li.png': 'Liechtenstein',
    'lk.png': 'Sri Lanka',
    'lr.png': 'Liberia',
    'ls.png': 'Lesotho',
    'lt.png': 'Lithuania',
    'lu.png': 'Luxembourg',
    'lv.png': 'Latvia',
    'ly.png': 'Libya',
    'ma.png': 'Morocco',
    'mc.png': 'Monaco',
    'md.png': 'Moldova',
    'me.png': 'Montenegro',
    'mf.png': 'Saint Martin',
    'mg.png': 'Madagascar',
    'mh.png': 'Marshall Islands',
    'mk.png': 'North Macedonia',
    'ml.png': 'Mali',
    'mm.png': 'Myanmar',
    'mn.png': 'Mongolia',
    'mo.png': 'Macao',
    'mp.png': 'Northern Mariana Islands',
    'mq.png': 'Martinique',
    'mr.png': 'Mauritania',
    'ms.png': 'Montserrat',
    'mt.png': 'Malta',
    'mu.png': 'Mauritius',
    'mv.png': 'Maldives',
    'mw.png': 'Malawi',
    'mx.png': 'Mexico',
    'my.png': 'Malaysia',
    'mz.png': 'Mozambique',
    'na.png': 'Namibia',
    'nc.png': 'New Caledonia',
    'ne.png': 'Niger',
    'nf.png': 'Norfolk Island',
    'ng.png': 'Nigeria',
    'ni.png': 'Nicaragua',
    'nl.png': 'Netherlands',
    'no.png': 'Norway',
    'np.png': 'Nepal',
    'nr.png': 'Nauru',
    'nu.png': 'Niue',
    'nz.png': 'New Zealand',
    'om.png': 'Oman',
    'pa.png': 'Paraguay',
    'pe.png': 'Peru',
    'pf.png': 'French Polynesia',
    'pg.png': 'Papua New Guinea',
    'ph.png': 'Philippines',
    'pk.png': 'Pakistan',
    'pl.png': 'Poland',
    'pm.png': 'Saint Pierre and Miquelon',
    'pn.png': 'Pitcairn Islands',
    'pr.png': 'Puerto Rico',
    'ps.png': 'Palestine',
    'pt.png': 'Portugal',
    'pw.png': 'Palau',
    'py.png': 'Paraguay',
    'qa.png': 'Qatar',
    're.png': 'Reunion',
    'ro.png': 'Romania',
    'rs.png': 'Serbia',
    'ru.png': 'Russia',
    'rw.png': 'Rwanda',
    'sa.png': 'Saudi Arabia',
    'sb.png': 'Solomon Islands',
    'sc.png': 'Seychelles',
    'sd.png': 'Sudan',
    'se.png': 'Sweden',
    'sg.png': 'Singapore',
    'sh.png': 'Saint Helena',
    'si.png': 'Slovenia',
    'sj.png': 'Svalbard and Jan Mayen',
    'sk.png': 'Slovakia',
    'sl.png': 'Sierra Leone',
    'sm.png': 'San Marino',
    'sn.png': 'Senegal',
    'so.png': 'Somalia',
    'sr.png': 'Suriname',
    'ss.png': 'South Sudan',
    'st.png': 'Sao Tome',
    'sv.png': 'El Salvador',
    'sx.png': 'Sint Maarten',
    'sy.png': 'Syria',
    'sz.png': 'Eswatini',
    'tc.png': 'Turks and Caicos Islands',
    'td.png': 'Chad',
    'tf.png': 'French Southern Territories',
    'tg.png': 'Togo',
    'th.png': 'Thailand',
    'tj.png': 'Tajikistan',
    'tk.png': 'Tokelau',
    'tl.png': 'Timor-Leste',
    'tm.png': 'Turkmenistan',
    'tn.png': 'Tunisia',
    'to.png': 'Tonga',
    'tr.png': 'Turkey',
    'tt.png': 'Trinidad and Tobago',
    'tv.png': 'Tuvalu',
    'tw.png': 'Taiwan',
    'tz.png': 'Tanzania',
    'ua.png': 'Ukraine',
    'ug.png': 'Uganda',
    'um.png': 'United States Minor Outlying Islands',
    'us.png': 'United States',
    'uy.png': 'Uruguay',
    'uz.png': 'Uzbekistan',
    'va.png': 'Vatican City',
    'vc.png': 'Saint Vincent and the Grenadines',
    've.png': 'Venezuela',
    'vg.png': 'British Virgin Islands',
    'vi.png': 'U.S. Virgin Islands',
    'vn.png': 'Vietnam',
    'vu.png': 'Vanuatu',
    'wf.png': 'Wallis and Futuna',
    'ws.png': 'Samoa',
    'xk.png': 'Kosovo',
    'ye.png': 'Yemen',
    'yt.png': 'Mayotte',
    'za.png': 'South Africa',
    'zm.png': 'Zambia',
    'zw.png': 'Zimbabwe'
}


const imageContainer = document.querySelector('#image-container');
const lives_hearts = document.querySelector('#lives_hearts');

function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

function easyList() {
    // Generate the initial list from 0 to 24
    var list = Array.from({ length: 25 }, (_, index) => index);

    // Shuffle the list using Fisher-Yates algorithm
    for (var i = list.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = list[i];
        list[i] = list[j];
        list[j] = temp;
    }
    return list
}

function createdificultyList() {
    var easylist = [];
    var mediumlist = [];
    var hardlist = [];
    for (var i = 0; i <= 24; i++) {
        easylist.push(i);
    }
    easylist.sort(function (a, b) {
        return 0.5 - Math.random();
    });
    for (var i = 25; i <= 100; i++) {
        mediumlist.push(i);
    }
    mediumlist.sort(function (a, b) {
        return 0.5 - Math.random();
    });
    for (var i = 101; i <= 256; i++) {
        hardlist.push(i);
    }
    hardlist.sort(function (a, b) {
        return 0.5 - Math.random();
    });
    var finished_list = easylist.concat(mediumlist, hardlist);
    return finished_list
}




//buttons
const button1 = document.getElementById('button1');
const button2 = document.getElementById('button2');
const button3 = document.getElementById('button3');
const button4 = document.getElementById('button4');
const button_elements = [button1, button2, button3, button4];

//make a variable to point to the directory of the image
keys = Object.keys(population_dictionary);
current_key = 0;
finished_list = createdificultyList()
current_flag_file = 'flags/' + keys[finished_list[current_key]];

fast = 0;
correct = 0;
fail = 0;
user_life = 1;
const livesElement = document.getElementById("lives")


current_score = 0;
const currentscoreElement = document.getElementById("currentscore")
currentscoreElement.textContent = 'CURRENT SCORE: ' + current_score;

user_high_score = 0;
const hishscoreElement = document.getElementById("highscore")
hishscoreElement.textContent = 'HIGH SCORE: ' + user_high_score;

// Create a new image element
imageElement = document.createElement('img');
const lifeElement = document.createElement('img');

// Set the source of the image element to a random image filename
imageElement.src = String(current_flag_file);

// Add the image element to the image container
imageContainer.appendChild(imageElement);



//making the heart images
function display_lives() {
    const lives_hearts = document.querySelector('#lives_hearts');
    const lifeElementSrc = 'heart.png';
    const numberOfLifeElements = user_life;
    const lifeElementWidth = 50;
    const spaceBetweenElements = 5;
    const containerWidth = numberOfLifeElements * (lifeElementWidth + spaceBetweenElements);

    lives_hearts.style.width = containerWidth + "px";
    lives_hearts.style.position = "fixed";
    lives_hearts.style.right = "0";

    for (let i = 0; i < numberOfLifeElements; i++) {
        const lifeElement = document.createElement("img");
        lifeElement.src = lifeElementSrc;
        lifeElement.style.width = lifeElementWidth + "px";
        lifeElement.style.height = "auto";
        lifeElement.style.marginLeft = (spaceBetweenElements * i) + "px";

        lives_hearts.appendChild(lifeElement);
    }
}
display_lives()

function removeLifeElements() {
    const lives_hearts = document.querySelector('#lives_hearts');

    while (lives_hearts.firstChild) {
        lives_hearts.removeChild(lives_hearts.firstChild);
    }
}

function refreshPage() {
    //document.getElementById('inputText').value = '';
    imageContainer.removeChild(imageElement);
    current_key = current_key + 1;
    document.body.style.backgroundColor = 'skyblue';
    document.getElementById("flag_zone").style.backgroundColor = "#ada8a8";
    button1.disabled = false;
    button2.disabled = false;
    button3.disabled = false;
    button4.disabled = false;
    //Update scores
    if (correct === 1) {
        current_score = current_score + 1;
        currentscoreElement.textContent = 'CURRENT SCORE: ' + current_score;
        correct = 0;
        //Update lives
        if ((current_score % 10 === 0 || current_score === 5) && user_life < 5) {
            user_life = user_life + 1;
            removeLifeElements()
            display_lives()
        }
    } else if (fail === 1 && user_life != 1) {
        user_life = user_life - 1;
        fail = 0;
        removeLifeElements()
        display_lives()
    } else if (fail === 1 && user_life === 1) {
        //game over
        last_score = current_score;
        current_score = 0;
        current_key = 0;
        if (last_score === user_high_score && last_score !== 0) {
            overlayContainer.style.display = 'block';
            scoreDisplay.textContent = 'Your Score: ' + last_score;
        }
        fail = 0;
        currentscoreElement.textContent = 'CURRENT SCORE: ' + current_score;
        finished_list = createdificultyList()
    }
    // update high score
    if (current_score > user_high_score) {
        user_high_score = current_score;
        hishscoreElement.textContent = 'HIGH SCORE: ' + user_high_score;
    }
    //update showing flag
    current_flag_file = 'flags/' + keys[finished_list[current_key]];
    imageElement.src = String(current_flag_file);
    imageContainer.appendChild(imageElement);
    document.getElementById("flag_zone").style.background = "linear-gradient(45deg, #b4f5b4, #FFC000, #b4f5b4)";

    //set button variables
    randomKeys = getRandomKeys(flag_dictionary, 3);
    sortedList = randomKeys.sort(randomSort);
    button1.innerText = sortedList[0].toString();
    button2.innerText = sortedList[1].toString();
    button3.innerText = sortedList[2].toString();
    button4.innerText = sortedList[3].toString();
    //remove the red background if answer was wrong
    for (var i = 0; i < button_elements.length; i++) {
        var button = button_elements[i];


        button.style.background = "";


        if (button.classList.contains("gold-border")) {
            button.classList.remove("gold-border");
        }
    }
    if (selectedButton) {
        selectedButton.classList.remove('selected');
    }
    button1answer = sortedList[0].toString()
    button2answer = sortedList[1].toString()
    button3answer = sortedList[2].toString()
    button4answer = sortedList[3].toString()
    adjustButtonText(button1);
    adjustButtonText(button2);
    adjustButtonText(button3);
    adjustButtonText(button4);

}

function checkInput(userInput) {
    event.preventDefault();

    var score = 0;
    var flag_name = checkKey();
    var minLength = Math.min(userInput.length, flag_name.length);

    for (var i = 0; i < minLength; i++) {
        if (userInput[i].toLowerCase() === flag_name[i].toLowerCase()) {
            score++;
        }
    }

    var matchPercentage = (score / flag_name.length) * 100;
    if (matchPercentage > 80) {
        selectedButton.classList.add("gold-border");
        document.getElementById("flag_zone").style.background = "linear-gradient(45deg, #278a27, #4dff4d, #278a27)";
        correct = 1;
    } else {
        document.getElementById("flag_zone").style.background = "linear-gradient(45deg, #4c0106, #f03232, #4c0106)";
        fail = 1;
        for (var i = 0; i < button_elements.length; i++) {
            var button = button_elements[i];

            if (button.innerText.trim() === flag_name) {
                button.style.background = "linear-gradient(45deg, #4c0106, #f03232, #4c0106)";
                button.classList.add("gold-border");
            }
        }
    }

    button1.disabled = true;
    button2.disabled = true;
    button3.disabled = true;
    button4.disabled = true;

    if (fast === 0 || fail === 1) {
        sleep(2000).then(() => { refreshPage() });
    } else {
        refreshPage()
    }
}



// Function to check if string matches a key in the dictionary
function checkKey() {
    var flag_file_name = current_flag_file.replace("flags/", "")
    for (var key in flag_dictionary) {
        if (flag_file_name === key) {
            return flag_dictionary[key];
        }
    }

    return null; // If no match found
}

let selectedButton = null;
function selectButton(buttonNumber) {
    if (selectedButton) {
        selectedButton.classList.remove('selected');
    }
    users_answer = '';
    selectedButton = document.getElementById('button' + buttonNumber);
    selectedButton.classList.add('selected');
    if (buttonNumber === 1) {
        users_answer = button1answer
    } else if (buttonNumber === 2) {
        users_answer = button2answer
    } else if (buttonNumber === 3) {
        users_answer = button3answer
    } else {
        users_answer = button4answer
    }
    checkInput(users_answer)
}



function getRandomKeys(dictionary, numKeys) {
    const keys = Object.keys(dictionary);
    const randomKeys = [];
    flag_name = checkKey();
    while (randomKeys.length < numKeys && keys.length > 0) {
        const randomIndex = Math.floor(Math.random() * keys.length);
        const randomKey = keys[randomIndex];

        if (flag_dictionary[randomKey] != flag_name) {
            randomKeys.push(flag_dictionary[randomKey]);
            keys.splice(randomIndex, 1);
        }
    }
    randomKeys.push(flag_name);
    return randomKeys;
}

function randomSort(a, b) {
    return Math.random() - 0.5;
}

// Set button variables
randomKeys = getRandomKeys(flag_dictionary, 3);
sortedList = randomKeys.sort(randomSort);

function splitTextIntoRows(text) {
    const maxLength = 16; // Maximum length of each row
    const words = text.split(' ');
    let row1 = '';
    let row2 = '';

    for (let i = 0; i < words.length; i++) {
        const word = words[i];
        if (row1.length + word.length <= maxLength) {
            row1 += word.trim() + ' ';
        } else {
            row2 += word.trim() + ' ';
        }
    }

    return [row1.trim(), row2.trim()];
}

function adjustButtonText(button) {
    const text = button.innerText;
    const buttonContent = button.querySelector('.button-text');
    if (text.length > 16) {
        const [row1, row2] = splitTextIntoRows(text);
        buttonContent.innerHTML = row1 + '<br>' + '<br>' + row2;
        button.classList.add('two-rows');
    } else {
        buttonContent.innerHTML = `<br>${text}<br><br>`;
        button.classList.remove('two-rows');
    }
}

button1.innerHTML = '<span class="button-text">' + sortedList[0].toString() + '</span>';
button2.innerHTML = '<span class="button-text">' + sortedList[1].toString() + '</span>';
button3.innerHTML = '<span class="button-text">' + sortedList[2].toString() + '</span>';
button4.innerHTML = '<span class="button-text">' + sortedList[3].toString() + '</span>';

button1answer = sortedList[0].toString()
button2answer = sortedList[1].toString()
button3answer = sortedList[2].toString()
button4answer = sortedList[3].toString()

adjustButtonText(button1);
adjustButtonText(button2);
adjustButtonText(button3);
adjustButtonText(button4);


//game over
const overlayContainer = document.getElementById('overlayContainer');
const scoreDisplay = document.getElementById('scoreDisplay');

function try_again() {
    overlayContainer.style.display = 'none';
}

const fast_image = document.getElementById('fast_image')
function fast_mode() {
    if (fast === 0) {
        fast = 1;
        fast_image.src = 'fast_speed.png'
    } else {
        fast = 0;
        fast_image.src = 'normal_speed.png'
    }
}